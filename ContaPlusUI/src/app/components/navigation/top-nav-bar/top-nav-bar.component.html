<nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light">
  <div class="collapse navbar-collapse">
    <div *ngIf="companyData">
      <h4 class="companyName">
        Current company:
        <span class="companyNameValue">{{ companyData[0]?.companyName || "doesn't exist" | uppercase }}</span>
      </h4>
    </div>


    <a class="navbar-brand" href="#">
      <img src="../../../assets/img/contaplus.png" alt="Logo" style="width: 150px; padding-top: 10px;">
    </a>

    <div class="dropdown">
      <img src="../../../assets/img/contaplusLOGO.png" alt="User Photo">
      <span class="username">{{ user?.firstName.split(' ')[0] | uppercase }} {{ user?.lastName.charAt(0) | uppercase
        }}.</span>
      <img src="../../../assets/img/dropdown.png" style="width: 15px; height: 15px; margin-left: 10px;">
      <div class="dropdown-content">
        <a href="#">My profile</a>
        <div *ngIf="showCompanyDropdown">
          <h6 style="margin-left: 15px; color: #5959e3; font-size: 12px;">Choose another company:</h6>
          <a *ngFor="let company of companies" (click)="selectCompany(company.companyId)" href="/dashboard">
            <img src="../../../assets/img/building.png" style="width: 20px; height: 20px; margin-left: 10px;"> {{
            company.companyName || "DOESN'T EXIST" }}</a>
        </div>
        <a (click)="isAddCompanyDialogOpen = true">Add new company</a>
        <a [href]="'/dashboard'" (click)="logout()" class="logoutBtn">Logout</a>
      </div>

    </div>
  </div>
</nav>

<div *ngIf="isAddCompanyDialogOpen" class="add-company-dialog">
  <h4 class="mb-4" mat-dialog-title>Add New Company</h4>
  <mat-error style="font-size: 14px;" *ngIf="addCompanyForm.controls['tradeRegister'].hasError('pattern')">
    Trade register must be in the format 'J01/123/4567'.
  </mat-error>

  <form [formGroup]="addCompanyForm" (ngSubmit)="onAddCompanySubmit()">
    <mat-dialog-content>
      <div class="row">
        <div class="col-md-6">
          <mat-form-field>
            <input matInput type="text" placeholder="Company Name" formControlName="companyName" name="companyName" required>
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-form-field>
            <input matInput type="email" placeholder="Email" formControlName="email" name="email" required>
          </mat-form-field>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <mat-form-field>
            <input matInput type="text" placeholder="Fiscal Code" formControlName="fiscalCode" name="fiscalCode">
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-form-field>
            <input matInput type="text" placeholder="Trade Register" formControlName="tradeRegister" name="tradeRegister">
          </mat-form-field>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <mat-form-field>
            <input matInput type="tel" placeholder="Phone Number" formControlName="phoneNumber" name="phoneNumber">
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-form-field>
            <input matInput type="text" placeholder="Address" formControlName="address" name="address">
          </mat-form-field>
        </div>
      </div>
      <div class="row">
        <div class="col-md-6">
          <mat-form-field>
            <input matInput type="text" placeholder="Social Capital" formControlName="socialCapital" name="socialCapital" required>
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-checkbox formControlName="tvaPayer" name="tvaPayer">TVA Payer</mat-checkbox>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
          <mat-dialog-actions>
            <button mat-raised-button 
            style="background-color: #4f4feb; color: white; margin-right: 10px;" 
            type="submit">Add Company</button>
            <button mat-button mat-dialog-close (click)="onCancel()">Cancel</button>
          </mat-dialog-actions>
        </div>
      </div>
    </mat-dialog-content>
  </form>
  </div>